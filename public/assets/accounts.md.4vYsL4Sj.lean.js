import{p as r,ah as ne,C as f,c as D,o as b,j as V,G as l,w as t,e as Ie,F as E,b as O,a as n,X as Ne,t as c,k as y,B as K,x as Me}from"./chunks/framework.lKnd1iSd.js";import{f as A,a as ue,c as P,g as Ke,b as Pe,d as qe,e as Ge,h as Je,i as se,j as re,u as Qe,k as Xe,l as He}from"./chunks/copy.B1Bwhxdm.js";import{E as w,a as de}from"./chunks/theme.BdKzsvvT.js";import"./chunks/request.fSkk4VTd.js";const We={style:{padding:"20px"}},Ye={class:"gva-search-box"},Ze={class:"gva-table-box"},el={class:"gva-btn-list"},ll={class:"gva-pagination"},tl={class:"flex justify-between items-center"},al={class:"text-lg"},ol={class:"flex justify-between items-center"},nl=Object.assign({name:"Accounts"},{__name:"accounts",setup(ie){(()=>{const o=typeof window<"u"?sessionStorage.getItem("uuid"):null;return o&&o.length>0?!0:(w.error("请先登录"),window.location.href="/login",!1)})();const B=r(!1),U=r([]),F=r([]),T=r([]),s=r({email:"",password:"",appcode:"",status:void 0,enable_status:void 0,access_token:"",coins:void 0,dr_level:void 0,stage_id:void 0,champions_points:void 0,transformarket_unlocked:void 0,record:""}),ce=ne({}),fe=ne({}),X=r(),H=r(),x=r(1),W=r(0),$=r(10),R=r([]),v=r({}),ve=()=>{v.value={},_()},q=()=>{var o;(o=H.value)==null||o.validate(async e=>{e&&(x.value=1,_())})},me=o=>{$.value=o,_()},be=o=>{x.value=o,_()},_=async()=>{const o=await Ke({page:x.value,pageSize:$.value,...v.value});o.code===0&&(R.value=o.data.list,W.value=o.data.total,x.value=o.data.page,$.value=o.data.pageSize)};_(),(async()=>{U.value=Pe(),F.value=qe(),T.value=Ge()})();const S=r([]),_e=o=>{S.value=o},ge=o=>{de.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ke(o)})},ye=async()=>{de.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const o=[];if(S.value.length===0){w({type:"warning",message:"请选择要删除的数据"});return}S.value&&S.value.map(d=>{o.push(d.id)}),(await Je({ids:o})).code===0&&(w({type:"success",message:"删除成功"}),R.value.length===o.length&&x.value>1&&x.value--,_())})},j=r(""),we=async o=>{const e=await se({id:o.id});j.value="update",e.code===0&&(s.value=e.data,z.value=!0)},ke=async o=>{(await He({id:o.id})).code===0&&(w({type:"success",message:"删除成功"}),R.value.length===1&&x.value>1&&x.value--,_())},z=r(!1),Ve=()=>{j.value="create",z.value=!0},G=()=>{z.value=!1,s.value={email:"",password:"",appcode:"",status:void 0,enable_status:void 0,access_token:"",coins:void 0,dr_level:void 0,stage_id:void 0,champions_points:void 0,transformarket_unlocked:void 0,record:""}},xe=async()=>{var o;(o=X.value)==null||o.validate(async e=>{if(!e)return;let d;switch(j.value){case"create":d=await re(s.value);break;case"update":d=await Qe(s.value);break;default:d=await re(s.value);break}d.code===0&&(w({type:"success",message:"创建/更改成功"}),G(),_())})},p=r({}),L=r(!1),he=()=>{L.value=!0},Ce=async o=>{const e=await se({id:o.id});e.code===0&&(p.value=e.data,he())},Se=()=>{L.value=!1,p.value={}};(async()=>{{const e=r(null);e.value=setInterval(()=>{_()},1e3*30),Me(()=>{clearInterval(e.value),e.value=null})}})();const Ae=o=>{const e=[];if(!o.record)return e;let d=o.record.split("; ");for(let i=0;i<d.length;i++){let u=d[i],m=u.indexOf("：");m>0?e.push({recordTime:u.slice(0,m),recordValue:u.slice(m+1)}):e.push({recordTime:"",recordValue:u})}return e},h=r({ids:[],enable_status:""}),I=r(!1),Y=async o=>{if(h.value.ids=[],o)h.value.ids.push(o.id);else{if(S.value.length===0){w({type:"warning",message:"请选择要启用的账号"});return}S.value&&S.value.map(e=>{h.value.ids.push(e.id)})}I.value=!0},J=()=>{I.value=!1,h.value.ids=[]},De=async()=>{(await Xe(h.value)).code===0&&(w({type:"success",message:"启用成功"}),J(),_())},Ue=o=>{v.value.prop=o.prop,v.value.order=o.order,_()},Fe=o=>{Object.entries(o).map(([e,d])=>{v.value[e]=d}),q()},Z=r({}),ee=r("/account/import"),Re=r(),Oe=o=>{const e=typeof window<"u"?sessionStorage.getItem("uuid"):null;return e&&e.length>0?(Z.value["x-uuid"]=e,!0):(ee.value="/account/import",w.error("请先登录"),window.location.href="/login",!1)},Be=o=>{o.code===0?(_(),w.success("导入成功")):w.error("导入失败："+o.message)},Te=async(o,e,d="text/plain")=>{const i=new Blob([o],{type:d}),u=URL.createObjectURL(i),m=document.createElement("a");m.href=u,m.download=e,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(u)},ze=async()=>{if(R.value.length===0){w.error("没有账号可以导出");return}let o="";R.value.forEach(e=>{o+=(e.email?e.email:"")+"----",o+=(e.password?e.password:"")+"----",o+=e.appcode?e.appcode:"",o+=(e.status?"----"+A(e.status,U.value):"")+`
`}),o.trimEnd(`
`),Te(o,"accounts.txt","text/plain")};return(o,e)=>{const d=f("el-input"),i=f("el-form-item"),u=f("el-button"),m=f("el-form"),Ee=f("el-upload"),k=f("el-table-column"),le=f("el-table"),$e=f("el-card"),te=f("el-icon"),je=f("el-pagination"),N=f("el-option"),M=f("el-select"),ae=f("el-input-number"),Q=f("el-drawer"),g=f("el-descriptions-item"),Le=f("el-descriptions"),oe=f("el-text");return b(),D("div",We,[V("div",Ye,[l(m,{ref_key:"elSearchFormRef",ref:H,inline:!0,model:v.value,class:"demo-form-inline",rules:fe,onKeyup:Ne(q,["enter"])},{default:t(()=>[l(i,{label:"邮箱",prop:"email"},{default:t(()=>[l(d,{modelValue:v.value.email,"onUpdate:modelValue":e[0]||(e[0]=a=>v.value.email=a),placeholder:"搜索邮箱"},null,8,["modelValue"])]),_:1}),l(i,{label:"操作记录",prop:"record"},{default:t(()=>[l(d,{modelValue:v.value.record,"onUpdate:modelValue":e[1]||(e[1]=a=>v.value.record=a),placeholder:"搜索记录"},null,8,["modelValue"])]),_:1}),B.value?(b(),D(E,{key:0},[],64)):Ie("",!0),l(i,null,{default:t(()=>[l(u,{type:"primary",icon:"search",onClick:q},{default:t(()=>e[23]||(e[23]=[n("查询")])),_:1}),l(u,{icon:"refresh",onClick:ve},{default:t(()=>e[24]||(e[24]=[n("重置")])),_:1}),B.value?(b(),O(u,{key:1,link:"",type:"primary",icon:"arrow-up",onClick:e[3]||(e[3]=a=>B.value=!1)},{default:t(()=>e[26]||(e[26]=[n("收起")])),_:1})):(b(),O(u,{key:0,link:"",type:"primary",icon:"arrow-down",onClick:e[2]||(e[2]=a=>B.value=!0)},{default:t(()=>e[25]||(e[25]=[n("展开")])),_:1}))]),_:1})]),_:1},8,["model","rules"])]),V("div",Ze,[V("div",el,[l(u,{type:"primary",icon:"plus",onClick:Ve},{default:t(()=>e[27]||(e[27]=[n("新增")])),_:1}),l(u,{icon:"delete",style:{"margin-left":"10px"},disabled:!S.value.length,onClick:ye},{default:t(()=>e[28]||(e[28]=[n("删除")])),_:1},8,["disabled"]),l(u,{type:"primary",icon:"SwitchButton",style:{"margin-left":"10px"},onClick:e[4]||(e[4]=a=>Y(!1))},{default:t(()=>e[29]||(e[29]=[n("启用账号")])),_:1}),l(Ee,{ref_key:"upload",ref:Re,action:ee.value,"show-file-list":!1,"on-success":Be,"before-upload":Oe,multiple:!1,headers:Z.value},{default:t(()=>[l(u,{type:"primary",icon:"upload",class:"ml-3"},{default:t(()=>e[30]||(e[30]=[n(" 导入账号 ")])),_:1})]),_:1},8,["action","headers"]),l(u,{type:"primary",icon:"Download",style:{"margin-left":"10px"},onClick:ze},{default:t(()=>e[31]||(e[31]=[n("导出账号")])),_:1})]),l(le,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:R.value,"row-key":"id",onSelectionChange:_e,"max-height":"600","default-sort":{prop:null,order:null},onSortChange:Ue,border:"",onFilterChange:Fe},{default:t(()=>[l(k,{type:"selection",width:"45"}),l(k,{type:"expand",width:"45"},{default:t(a=>[l($e,null,{default:t(()=>[l(le,{data:Ae(a.row),"max-height":"300"},{default:t(()=>[l(k,{label:"时间",prop:"recordTime",width:"200","show-overflow-tooltip":!0}),l(k,{label:"记录",prop:"recordValue","min-width":"300","show-overflow-tooltip":!0})]),_:2},1032,["data"])]),_:2},1024)]),_:1}),l(k,{align:"left",label:"邮箱",prop:"email",width:"180","show-overflow-tooltip":!0}),l(k,{align:"left",label:"账号状态",prop:"status",width:"120",sortable:"custom","show-overflow-tooltip":!0,"column-key":"status",filters:U.value,"filtered-value":v.value.status},{default:t(a=>[n(c(y(A)(a.row.status,U.value)),1)]),_:1},8,["filters","filtered-value"]),l(k,{align:"left",label:"启用状态",prop:"enable_status",width:"120",sortable:"custom","show-overflow-tooltip":!0,"column-key":"enable_status",filters:F.value,"filtered-value":v.value.enable_status},{default:t(a=>[n(c(y(A)(a.row.enable_status,F.value)),1)]),_:1},8,["filters","filtered-value"]),l(k,{align:"left",label:"DR等级",prop:"dr_level",width:"120",sortable:"custom","show-overflow-tooltip":!0,"column-key":"dr_level",filters:T.value,"filtered-value":v.value.dr_level},{default:t(a=>[n(c(y(A)(a.row.dr_level,T.value)),1)]),_:1},8,["filters","filtered-value"]),l(k,{align:"left",label:"转会市场",prop:"transformarket_unlocked",width:"110","column-key":"transformarket_unlocked",filters:[{text:"已解锁",value:!0},{text:"未解锁",value:!1}],"filtered-value":v.value.transformarket_unlocked},{default:t(a=>[n(c(y(ue)(a.row.transformarket_unlocked)),1)]),_:1},8,["filtered-value"]),l(k,{align:"left",label:"操作",fixed:"right","min-width":"240"},{default:t(a=>[l(u,{type:"primary",link:"",class:"table-button",onClick:C=>Ce(a.row)},{default:t(()=>[l(te,{style:{"margin-right":"5px"}}),e[32]||(e[32]=n("查看"))]),_:2},1032,["onClick"]),l(u,{type:"primary",link:"",class:"table-button",onClick:C=>Y(a.row)},{default:t(()=>[l(te,{style:{"margin-right":"5px"}}),e[33]||(e[33]=n("启用"))]),_:2},1032,["onClick"]),l(u,{type:"primary",link:"",icon:"edit",class:"table-button",onClick:C=>we(a.row)},{default:t(()=>e[34]||(e[34]=[n("编辑")])),_:2},1032,["onClick"]),l(u,{type:"Danger",link:"",icon:"delete",onClick:C=>ge(a.row)},{default:t(()=>e[35]||(e[35]=[n("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),V("div",ll,[l(je,{layout:"total, sizes, prev, pager, next, jumper","current-page":x.value,"page-size":$.value,"page-sizes":[10,30,50,100,200,500,1e3],total:W.value,onCurrentChange:be,onSizeChange:me},null,8,["current-page","page-size","total"])])]),l(Q,{"destroy-on-close":"",size:"800",modelValue:z.value,"onUpdate:modelValue":e[15]||(e[15]=a=>z.value=a),"show-close":!1,"before-close":G},{header:t(()=>[V("div",tl,[V("span",al,c(j.value==="create"?"新增":"编辑"),1),V("div",null,[l(u,{type:"primary",onClick:xe},{default:t(()=>e[36]||(e[36]=[n("确 定")])),_:1}),l(u,{onClick:G},{default:t(()=>e[37]||(e[37]=[n("取 消")])),_:1})])])]),default:t(()=>[l(m,{model:s.value,"label-position":"top",ref_key:"elFormRef",ref:X,rules:ce,"label-width":"80px"},{default:t(()=>[l(i,{label:"邮箱:",prop:"email"},{default:t(()=>[l(d,{modelValue:s.value.email,"onUpdate:modelValue":e[5]||(e[5]=a=>s.value.email=a),clearable:!0,placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(i,{label:"密码:",prop:"password"},{default:t(()=>[l(d,{modelValue:s.value.password,"onUpdate:modelValue":e[6]||(e[6]=a=>s.value.password=a),clearable:!0,placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),l(i,{label:"16位码:",prop:"appcode"},{default:t(()=>[l(d,{modelValue:s.value.appcode,"onUpdate:modelValue":e[7]||(e[7]=a=>s.value.appcode=a),clearable:!0,placeholder:"请输入16位码"},null,8,["modelValue"])]),_:1}),l(i,{label:"账号状态:",prop:"status"},{default:t(()=>[l(M,{modelValue:s.value.status,"onUpdate:modelValue":e[8]||(e[8]=a=>s.value.status=a),placeholder:"请选择状态",style:{width:"100%"},clearable:!0},{default:t(()=>[(b(!0),D(E,null,K(U.value,(a,C)=>(b(),O(N,{key:C,label:a.text,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"启用状态:",prop:"enable_status"},{default:t(()=>[l(M,{modelValue:s.value.enable_status,"onUpdate:modelValue":e[9]||(e[9]=a=>s.value.enable_status=a),placeholder:"请选择状态",style:{width:"100%"},clearable:!0},{default:t(()=>[(b(!0),D(E,null,K(F.value,(a,C)=>(b(),O(N,{key:C,label:a.text,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"access_token:",prop:"token"},{default:t(()=>[l(d,{modelValue:s.value.access_token,"onUpdate:modelValue":e[10]||(e[10]=a=>s.value.access_token=a),clearable:!0,placeholder:"请输入access_token"},null,8,["modelValue"])]),_:1}),l(i,{label:"金币：",prop:"coins"},{default:t(()=>[l(ae,{modelValue:s.value.coins,"onUpdate:modelValue":e[11]||(e[11]=a=>s.value.coins=a),modelModifiers:{number:!0},clearable:!0,style:{width:"200px"},placeholder:"请输入金币数量"},null,8,["modelValue"])]),_:1}),l(i,{label:"DR等级：",prop:"dr_level"},{default:t(()=>[l(M,{modelValue:s.value.dr_level,"onUpdate:modelValue":e[12]||(e[12]=a=>s.value.dr_level=a),placeholder:"请选择DR等级",style:{width:"100%"},clearable:!0},{default:t(()=>[(b(!0),D(E,null,K(T.value,a=>(b(),O(N,{key:a.value,label:a.text,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"胜点：",prop:"champions_points"},{default:t(()=>[l(ae,{modelValue:s.value.champions_points,"onUpdate:modelValue":e[13]||(e[13]=a=>s.value.champions_points=a),modelModifiers:{number:!0},clearable:!0,style:{width:"200px"},placeholder:"请输入胜点"},null,8,["modelValue"])]),_:1}),l(i,{label:"操作记录:",prop:"record"},{default:t(()=>[l(d,{modelValue:s.value.record,"onUpdate:modelValue":e[14]||(e[14]=a=>s.value.record=a),clearable:!0,placeholder:"请输入操作记录"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l(Q,{"destroy-on-close":"",size:"800",modelValue:L.value,"onUpdate:modelValue":e[20]||(e[20]=a=>L.value=a),"show-close":!0,"before-close":Se,title:"查看"},{default:t(()=>[l(Le,{column:1,border:""},{default:t(()=>[l(g,null,{label:t(()=>[l(u,{link:"",onClick:e[16]||(e[16]=a=>y(P)(p.value.email))},{default:t(()=>e[38]||(e[38]=[n(" 邮箱 ")])),_:1})]),default:t(()=>[n(" "+c(p.value.email),1)]),_:1}),l(g,{label:"密码"},{label:t(()=>[l(u,{link:"",onClick:e[17]||(e[17]=a=>y(P)(p.value.password))},{default:t(()=>e[39]||(e[39]=[n(" 密码 ")])),_:1})]),default:t(()=>[n(" "+c(p.value.password),1)]),_:1}),l(g,{label:"16位码"},{label:t(()=>[l(u,{link:"",onClick:e[18]||(e[18]=a=>y(P)(p.value.appcode))},{default:t(()=>e[40]||(e[40]=[n(" 16位码 ")])),_:1})]),default:t(()=>[n(" "+c(p.value.appcode),1)]),_:1}),l(g,{label:"账号状态"},{default:t(()=>[n(c(y(A)(p.value.status,U.value)),1)]),_:1}),l(g,{label:"启用状态"},{default:t(()=>[n(c(y(A)(p.value.enable_status,F.value)),1)]),_:1}),l(g,{label:"access_token"},{label:t(()=>[l(u,{link:"",onClick:e[19]||(e[19]=a=>y(P)(p.value.access_token))},{default:t(()=>e[41]||(e[41]=[n(" access_token ")])),_:1})]),default:t(()=>[n(" "+c(p.value.access_token),1)]),_:1}),l(g,{label:"金币"},{default:t(()=>[n(c(p.value.coins),1)]),_:1}),l(g,{label:"DR等级"},{default:t(()=>[n(c(y(A)(p.value.dr_level,T.value)),1)]),_:1}),l(g,{label:"StageId"},{default:t(()=>[n(c(p.value.stage_id),1)]),_:1}),l(g,{label:"胜点"},{default:t(()=>[n(c(p.value.champions_points),1)]),_:1}),l(g,{label:"转会市场"},{default:t(()=>[n(c(y(ue)(p.value.transformarket_unlocked)),1)]),_:1}),l(g,{label:"操作记录"},{default:t(()=>[n(c(p.value.record),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Q,{size:"800",modelValue:I.value,"onUpdate:modelValue":e[22]||(e[22]=a=>I.value=a),"show-close":!0,"before-close":J,title:"启用账号","destory-on-close":""},{header:t(()=>[V("div",ol,[e[44]||(e[44]=V("span",{class:"text-lg"},"启用账号",-1)),V("div",null,[l(u,{type:"primary",onClick:De},{default:t(()=>e[42]||(e[42]=[n("确定")])),_:1}),l(u,{onClick:J},{default:t(()=>e[43]||(e[43]=[n("取消")])),_:1})])])]),default:t(()=>[l(m,{model:h.value,"label-position":"top","label-width":"80px"},{default:t(()=>[l(i,{label:"选中的账号"},{default:t(()=>[l(oe,{class:"mx-1"},{default:t(()=>e[45]||(e[45]=[n("选中的账号数量：")])),_:1}),e[46]||(e[46]=n()),l(oe,{class:"mx-1",type:"primary"},{default:t(()=>[n(c(h.value.ids.length),1)]),_:1})]),_:1}),l(i,{label:"启用状态:",prop:"enable_status"},{default:t(()=>[l(M,{modelValue:h.value.enable_status,"onUpdate:modelValue":e[21]||(e[21]=a=>h.value.enable_status=a),placeholder:"请选择状态",style:{width:"100%"},clearable:!0},{default:t(()=>[(b(!0),D(E,null,K(F.value,(a,C)=>(b(),O(N,{key:C,label:a.text,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),fl=JSON.parse('{"title":"Accounts","description":"","frontmatter":{"layout":"page","title":"Accounts"},"headers":[],"relativePath":"accounts.md","filePath":"accounts.md"}'),ul={name:"accounts.md"},vl=Object.assign(ul,{setup(ie){return(pe,B)=>(b(),D("div",null,[l(nl)]))}});export{fl as __pageData,vl as default};
